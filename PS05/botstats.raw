0: jdbc:hive2://localhost:10000> -- Set up config options based on documentation
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> SET mapred.input.dir.recursive=true;
0: jdbc:hive2://localhost:10000> SET hive.mapred.supports.subdirectories=true;
0: jdbc:hive2://localhost:10000> SET hive.groupby.orderby.position.alias=true;
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> DROP TABLE IF EXISTS raw_logs;
0: jdbc:hive2://localhost:10000> CREATE EXTERNAL TABLE raw_logs (
. . . . . . . . . . . . . . . .>   host STRING,
. . . . . . . . . . . . . . . .>   identity STRING,
. . . . . . . . . . . . . . . .>   user STRING,
. . . . . . . . . . . . . . . .>   rawdatetime STRING,
. . . . . . . . . . . . . . . .>   request STRING,
. . . . . . . . . . . . . . . .>   status STRING,
. . . . . . . . . . . . . . . .>   size STRING,
. . . . . . . . . . . . . . . .>   refer STRING,
. . . . . . . . . . . . . . . .>   agent STRING
. . . . . . . . . . . . . . . .>   )
. . . . . . . . . . . . . . . .> ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
. . . . . . . . . . . . . . . .> WITH SERDEPROPERTIES (
. . . . . . . . . . . . . . . .>   "input.regex" = "([^ ]*) ([^ ]*) ([^ ]*) (-|\\[[^\\]]*\\]) ([^ \"]*|\"[^\"]*\") (-|[0-9]*) (-|[0-9]*) \"([^\"]*)\" \"([^\"]*)\".*",
. . . . . . . . . . . . . . . .>   "output.format.string" = "%1$s %2$s %3$s %4$s %5$s %6$s %7$s %8$s %9$s"
. . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . .> STORED AS TEXTFILE
. . . . . . . . . . . . . . . .> LOCATION 's3://gu-anly502/ps05/forensicswiki/2012/';
0: jdbc:hive2://localhost:10000> --LOCATION 's3://gu-anly502/ps05/forensicswiki/2012/12/';
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> DROP TABLE IF EXISTS bot_logs;
0: jdbc:hive2://localhost:10000> create temporary table bot_logs (
. . . . . . . . . . . . . . . .>   date  timestamp,
. . . . . . . . . . . . . . . .>   size  bigint,
. . . . . . . . . . . . . . . .>   agent string,
. . . . . . . . . . . . . . . .>   bot   boolean
. . . . . . . . . . . . . . . .> );
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> insert overwrite table bot_logs
. . . . . . . . . . . . . . . .>   select from_unixtime(unix_timestamp(rawdatetime, "[dd/MMM/yyyy:HH:mm:ss Z]")),
. . . . . . . . . . . . . . . .>          int(size),
. . . . . . . . . . . . . . . .>          agent,
. . . . . . . . . . . . . . . .>          instr(lower(agent),"bot")>0
. . . . . . . . . . . . . . . .>   from raw_logs;
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> create temporary table bot_stats (
. . . . . . . . . . . . . . . .>   yearmonth string,
. . . . . . . . . . . . . . . .>   count bigint,
. . . . . . . . . . . . . . . .>   botcount bigint,
. . . . . . . . . . . . . . . .>   nonbotcount bigint,
. . . . . . . . . . . . . . . .>   size bigint,
. . . . . . . . . . . . . . . .>   botsize bigint,
. . . . . . . . . . . . . . . .>   nonbotsize bigint
. . . . . . . . . . . . . . . .> );
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> insert overwrite table bot_stats
. . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . .> substr(date,1,10),
. . . . . . . . . . . . . . . .> count(*),
. . . . . . . . . . . . . . . .> sum(IF(bot,1,0)),
. . . . . . . . . . . . . . . .> sum(IF(bot,0,1)),
. . . . . . . . . . . . . . . .> sum(size),
. . . . . . . . . . . . . . . .> sum(IF(bot,size,0)),
. . . . . . . . . . . . . . . .> sum(IF(bot,0,size))
. . . . . . . . . . . . . . . .> from bot_logs
. . . . . . . . . . . . . . . .> group by substr(date,1,10);
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> select yearmonth,count,botcount,nonbotcount,size,botsize,nonbotsize from bot_stats order by yearmonth;
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
|  yearmonth  |  count  | botcount  | nonbotcount  |    size     |  botsize   | nonbotsize  |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
| NULL        | 1684    | 0         | 1684         | NULL        | 0          | NULL        |
| 2012-01-01  | 18835   | 536       | 18299        | 133383554   | 2178468    | 131205086   |
| 2012-01-02  | 38794   | 3188      | 35606        | 266986752   | 11419611   | 255567141   |
| 2012-01-03  | 45924   | 1198      | 44726        | 339392633   | 6202624    | 333190009   |
| 2012-01-04  | 50432   | 1149      | 49283        | 430011731   | 5778434    | 424233297   |
| 2012-01-05  | 49408   | 1303      | 48105        | 445173531   | 7392269    | 437781262   |
| 2012-01-06  | 46728   | 1180      | 45548        | 406034412   | 9098485    | 396935927   |
| 2012-01-07  | 31695   | 2552      | 29143        | 234622692   | 12798429   | 221824263   |
| 2012-01-08  | 31455   | 1270      | 30185        | 245758179   | 6795219    | 238962960   |
| 2012-01-09  | 58645   | 3327      | 55318        | 472314351   | 13732033   | 458582318   |
| 2012-01-10  | 49732   | 1156      | 48576        | 405982956   | 5398220    | 400584736   |
| 2012-01-11  | 54871   | 1193      | 53678        | 438367696   | 9676886    | 428690810   |
| 2012-01-12  | 60896   | 2158      | 58738        | 477175377   | 20205056   | 456970321   |
| 2012-01-13  | 56411   | 1353      | 55058        | 433970629   | 8470004    | 425500625   |
| 2012-01-14  | 35936   | 1321      | 34615        | 277263912   | 5534617    | 271729295   |
| 2012-01-15  | 37604   | 1322      | 36282        | 279945842   | 5861021    | 274084821   |
| 2012-01-16  | 58347   | 3593      | 54754        | 446681023   | 15387181   | 431293842   |
| 2012-01-17  | 143335  | 1206      | 142129       | 1114418888  | 10057480   | 1104361408  |
| 2012-01-18  | 90802   | 1947      | 88855        | 752194152   | 13647789   | 738546363   |
| 2012-01-19  | 52065   | 1574      | 50491        | 411069374   | 13731060   | 397338314   |
| 2012-01-20  | 47179   | 1462      | 45717        | 383980266   | 10758125   | 373222141   |
| 2012-01-21  | 33068   | 2108      | 30960        | 258610622   | 11642294   | 246968328   |
| 2012-01-22  | 33077   | 1413      | 31664        | 266467340   | 11145625   | 255321715   |
| 2012-01-23  | 51052   | 3758      | 47294        | 409803126   | 26242483   | 383560643   |
| 2012-01-24  | 54126   | 2023      | 52103        | 455070592   | 14672824   | 440397768   |
| 2012-01-25  | 51502   | 3790      | 47712        | 426491543   | 44927300   | 381564243   |
| 2012-01-26  | 50496   | 1327      | 49169        | 403510655   | 8316219    | 395194436   |
| 2012-01-27  | 45430   | 1263      | 44167        | 361472368   | 9028521    | 352443847   |
| 2012-01-28  | 32723   | 2399      | 30324        | 264613572   | 15179039   | 249434533   |
| 2012-01-29  | 20809   | 700       | 20109        | 163829630   | 3407782    | 160421848   |
| 2012-01-30  | 50397   | 2344      | 48053        | 419266795   | 13562420   | 405704375   |
| 2012-01-31  | 49335   | 1164      | 48171        | 402194265   | 7967527    | 394226738   |
| 2012-02-01  | 52385   | 780       | 51605        | 460402412   | 4710200    | 455692212   |
| 2012-02-02  | 51541   | 919       | 50622        | 478591826   | 5187517    | 473404309   |
| 2012-02-03  | 45985   | 1497      | 44488        | 390504669   | 8711211    | 381793458   |
| 2012-02-04  | 43999   | 1123      | 42876        | 346962477   | 7978597    | 338983880   |
| 2012-02-05  | 65487   | 1306      | 64181        | 527026459   | 8560083    | 518466376   |
| 2012-02-06  | 50820   | 1681      | 49139        | 411196123   | 10979151   | 400216972   |
| 2012-02-07  | 51813   | 1055      | 50758        | 431927145   | 6419404    | 425507741   |
| 2012-02-08  | 52610   | 1023      | 51587        | 512249239   | 5535803    | 506713436   |
| 2012-02-09  | 51975   | 1213      | 50762        | 485946656   | 6507763    | 479438893   |
| 2012-02-10  | 46845   | 1141      | 45704        | 396735392   | 6072239    | 390663153   |
| 2012-02-11  | 31566   | 1119      | 30447        | 252527331   | 6474637    | 246052694   |
| 2012-02-12  | 33819   | 1134      | 32685        | 272198595   | 8884689    | 263313906   |
| 2012-02-13  | 49076   | 1422      | 47654        | 394501165   | 7790614    | 386710551   |
| 2012-02-14  | 50447   | 941       | 49506        | 429338057   | 5887168    | 423450889   |
| 2012-02-15  | 50119   | 1420      | 48699        | 405019422   | 10213395   | 394806027   |
| 2012-02-16  | 52558   | 2315      | 50243        | 420918626   | 31328014   | 389590612   |
| 2012-02-17  | 46203   | 1221      | 44982        | 374148457   | 9138480    | 365009977   |
| 2012-02-18  | 34032   | 1965      | 32067        | 274745575   | 14504572   | 260241003   |
| 2012-02-19  | 34366   | 1170      | 33196        | 273556599   | 7535321    | 266021278   |
| 2012-02-20  | 59376   | 1209      | 58167        | 476651952   | 5797760    | 470854192   |
| 2012-02-21  | 59775   | 1246      | 58529        | 559804077   | 10149081   | 549654996   |
| 2012-02-22  | 44700   | 1922      | 42778        | 981709744   | 18770184   | 962939560   |
| 2012-02-23  | 43455   | 2616      | 40839        | 907374742   | 18592083   | 888782659   |
| 2012-02-24  | 40206   | 3335      | 36871        | 791055330   | 20038272   | 771017058   |
| 2012-02-25  | 28916   | 2326      | 26590        | 619136670   | 18858568   | 600278102   |
| 2012-02-26  | 22202   | 2431      | 19771        | 335098834   | 11909790   | 323189044   |
| 2012-02-27  | 43334   | 5367      | 37967        | 900009671   | 33901480   | 866108191   |
| 2012-02-28  | 45812   | 5231      | 40581        | 966308918   | 34951950   | 931356968   |
| 2012-02-29  | 43658   | 3431      | 40227        | 924613373   | 24471533   | 900141840   |
| 2012-03-01  | 41948   | 3132      | 38816        | 906983505   | 26938550   | 880044955   |
| 2012-03-02  | 45264   | 1901      | 43363        | 882588484   | 17213120   | 865375364   |
| 2012-03-03  | 27550   | 2609      | 24941        | 610095391   | 27416506   | 582678885   |
| 2012-03-04  | 30263   | 5074      | 25189        | 639533404   | 57739816   | 581793588   |
| 2012-03-05  | 40117   | 3620      | 36497        | 956883306   | 32637902   | 924245404   |
| 2012-03-06  | 44240   | 2928      | 41312        | 1093915643  | 31781698   | 1062133945  |
| 2012-03-07  | 44528   | 3327      | 41201        | 965434743   | 24691223   | 940743520   |
| 2012-03-08  | 42337   | 5187      | 37150        | 996843244   | 52408101   | 944435143   |
| 2012-03-09  | 37860   | 2078      | 35782        | 875270656   | 21199464   | 854071192   |
| 2012-03-10  | 27391   | 2676      | 24715        | 583087118   | 21863449   | 561223669   |
| 2012-03-11  | 26582   | 2501      | 24081        | 567505942   | 21341050   | 546164892   |
| 2012-03-12  | 43002   | 2204      | 40798        | 989269213   | 17368703   | 971900510   |
| 2012-03-13  | 38681   | 1486      | 37195        | 894012989   | 13143095   | 880869894   |
| 2012-03-14  | 43759   | 1736      | 42023        | 966405186   | 19356312   | 947048874   |
| 2012-03-15  | 52394   | 4724      | 47670        | 1110571114  | 30391262   | 1080179852  |
| 2012-03-16  | 47220   | 9006      | 38214        | 911500391   | 110490905  | 801009486   |
| 2012-03-17  | 32577   | 9645      | 22932        | 627640416   | 110377659  | 517262757   |
| 2012-03-18  | 42480   | 17122     | 25358        | 748196003   | 195478261  | 552717742   |
| 2012-03-19  | 60507   | 17532     | 42975        | 1145115421  | 166491387  | 978624034   |
| 2012-03-20  | 51038   | 9474      | 41564        | 1087296988  | 105062642  | 982234346   |
| 2012-03-21  | 62807   | 6654      | 56153        | 1020628067  | 71986685   | 948641382   |
| 2012-03-22  | 65188   | 8342      | 56846        | 957088499   | 85315052   | 871773447   |
| 2012-03-23  | 46730   | 6784      | 39946        | 847820593   | 70478929   | 777341664   |
| 2012-03-24  | 28794   | 5123      | 23671        | 597473892   | 50579041   | 546894851   |
| 2012-03-25  | 26677   | 2154      | 24523        | 575078651   | 25215577   | 549863074   |
| 2012-03-26  | 42238   | 2694      | 39544        | 1000174670  | 26606050   | 973568620   |
| 2012-03-27  | 39477   | 1303      | 38174        | 910589665   | 11130714   | 899458951   |
| 2012-03-28  | 44439   | 2224      | 42215        | 1034455885  | 24909984   | 1009545901  |
| 2012-03-29  | 42756   | 4259      | 38497        | 952710814   | 29947050   | 922763764   |
| 2012-03-30  | 35533   | 2389      | 33144        | 758285724   | 31321231   | 726964493   |
| 2012-03-31  | 25241   | 3573      | 21668        | 519658418   | 29269543   | 490388875   |
| 2012-04-01  | 24133   | 1771      | 22362        | 514263644   | 19092549   | 495171095   |
| 2012-04-02  | 36156   | 2149      | 34007        | 830947763   | 17556430   | 813391333   |
| 2012-04-03  | 41799   | 5983      | 35816        | 875858915   | 28901591   | 846957324   |
| 2012-04-04  | 39094   | 4911      | 34183        | 791745763   | 29414142   | 762331621   |
| 2012-04-05  | 34454   | 1705      | 32749        | 783868186   | 13510715   | 770357471   |
| 2012-04-06  | 29225   | 2285      | 26940        | 634138900   | 20801277   | 613337623   |
| 2012-04-07  | 21225   | 1769      | 19456        | 447453375   | 20489302   | 426964073   |
| 2012-04-08  | 22324   | 1665      | 20659        | 465218532   | 11407240   | 453811292   |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
|  yearmonth  |  count  | botcount  | nonbotcount  |    size     |  botsize   | nonbotsize  |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
| 2012-04-09  | 34604   | 1900      | 32704        | 631211717   | 19761155   | 611450562   |
| 2012-04-10  | 42300   | 3094      | 39206        | 547874441   | 14681678   | 533192763   |
| 2012-04-11  | 39156   | 2852      | 36304        | 511612487   | 17605301   | 494007186   |
| 2012-04-12  | 37889   | 3605      | 34284        | 493229077   | 22116585   | 471112492   |
| 2012-04-13  | 33710   | 2306      | 31404        | 435094815   | 12012013   | 423082802   |
| 2012-04-14  | 24945   | 2158      | 22787        | 460646267   | 9557819    | 451088448   |
| 2012-04-15  | 26265   | 2778      | 23487        | 315459738   | 12540364   | 302919374   |
| 2012-04-16  | 37793   | 3292      | 34501        | 492911844   | 19851109   | 473060735   |
| 2012-04-17  | 39976   | 2436      | 37540        | 537639295   | 20671470   | 516967825   |
| 2012-04-18  | 39458   | 3972      | 35486        | 506917577   | 22331282   | 484586295   |
| 2012-04-19  | 37650   | 1587      | 36063        | 496927153   | 13205933   | 483721220   |
| 2012-04-20  | 34936   | 1123      | 33813        | 447369065   | 6273586    | 441095479   |
| 2012-04-21  | 25123   | 1984      | 23139        | 317691044   | 10178584   | 307512460   |
| 2012-04-22  | 30983   | 1721      | 29262        | 374365819   | 7736485    | 366629334   |
| 2012-04-23  | 39030   | 1984      | 37046        | 509008753   | 15769489   | 493239264   |
| 2012-04-24  | 42270   | 4152      | 38118        | 559548699   | 40199763   | 519348936   |
| 2012-04-25  | 37949   | 2195      | 35754        | 498433247   | 19293507   | 479139740   |
| 2012-04-26  | 38988   | 4127      | 34861        | 529832497   | 57876638   | 471955859   |
| 2012-04-27  | 35933   | 2724      | 33209        | 465501088   | 18837301   | 446663787   |
| 2012-04-28  | 25583   | 2181      | 23402        | 313668906   | 14856104   | 298812802   |
| 2012-04-29  | 25897   | 2055      | 23842        | 312158082   | 12965870   | 299192212   |
| 2012-04-30  | 35387   | 2204      | 33183        | 462315250   | 12541875   | 449773375   |
| 2012-05-01  | 32989   | 2404      | 30585        | 431339081   | 20553171   | 410785910   |
| 2012-05-02  | 39881   | 2706      | 37175        | 528479968   | 18767726   | 509712242   |
| 2012-05-03  | 43114   | 2894      | 40220        | 580292428   | 27973702   | 552318726   |
| 2012-05-04  | 35514   | 2651      | 32863        | 466838755   | 18404080   | 448434675   |
| 2012-05-05  | 27293   | 3738      | 23555        | 322995915   | 23464460   | 299531455   |
| 2012-05-06  | 29985   | 5820      | 24165        | 342474945   | 46606368   | 295868577   |
| 2012-05-07  | 39786   | 3918      | 35868        | 501155181   | 25931788   | 475223393   |
| 2012-05-08  | 40871   | 2689      | 38182        | 535326980   | 21411649   | 513915331   |
| 2012-05-09  | 40035   | 2973      | 37062        | 524187815   | 25393277   | 498794538   |
| 2012-05-10  | 40627   | 2853      | 37774        | 527331724   | 14778139   | 512553585   |
| 2012-05-11  | 56502   | 2248      | 54254        | 656662283   | 18417016   | 638245267   |
| 2012-05-12  | 26102   | 3114      | 22988        | 308117071   | 20257157   | 287859914   |
| 2012-05-13  | 24160   | 2774      | 21386        | 287052228   | 22487893   | 264564335   |
| 2012-05-14  | 40032   | 4350      | 35682        | 508595031   | 32262438   | 476332593   |
| 2012-05-15  | 44049   | 6293      | 37756        | 531901308   | 38338554   | 493562754   |
| 2012-05-16  | 41614   | 4570      | 37044        | 514835307   | 24209371   | 490625936   |
| 2012-05-17  | 38195   | 1921      | 36274        | 478691299   | 12898616   | 465792683   |
| 2012-05-18  | 34285   | 1938      | 32347        | 429299952   | 14712959   | 414586993   |
| 2012-05-19  | 25569   | 2450      | 23119        | 303194661   | 21720489   | 281474172   |
| 2012-05-20  | 27358   | 2758      | 24600        | 315091764   | 26508000   | 288583764   |
| 2012-05-21  | 41043   | 3659      | 37384        | 513623127   | 21329484   | 492293643   |
| 2012-05-22  | 38777   | 2172      | 36605        | 514927843   | 15835687   | 499092156   |
| 2012-05-23  | 38696   | 2275      | 36421        | 491047648   | 17325222   | 473722426   |
| 2012-05-24  | 41201   | 2227      | 38974        | 516376125   | 15232470   | 501143655   |
| 2012-05-25  | 40155   | 2745      | 37410        | 456060768   | 21717498   | 434343270   |
| 2012-05-26  | 33064   | 2570      | 30494        | 333572347   | 17924888   | 315647459   |
| 2012-05-27  | 31743   | 2869      | 28874        | 331810334   | 24213364   | 307596970   |
| 2012-05-28  | 39692   | 4578      | 35114        | 421590859   | 26574365   | 395016494   |
| 2012-05-29  | 45775   | 3300      | 42475        | 515350848   | 26442317   | 488908531   |
| 2012-05-30  | 48034   | 4639      | 43395        | 535004415   | 21446463   | 513557952   |
| 2012-05-31  | 43045   | 4705      | 38340        | 475503199   | 22974320   | 452528879   |
| 2012-06-01  | 42857   | 4274      | 38583        | 470645228   | 25461328   | 445183900   |
| 2012-06-02  | 38566   | 4671      | 33895        | 409661123   | 38234808   | 371426315   |
| 2012-06-03  | 37143   | 3918      | 33225        | 382193576   | 26496109   | 355697467   |
| 2012-06-04  | 45044   | 5136      | 39908        | 487572084   | 32790061   | 454782023   |
| 2012-06-05  | 46942   | 6041      | 40901        | 518831796   | 47344066   | 471487730   |
| 2012-06-06  | 46653   | 3826      | 42827        | 539070553   | 26235153   | 512835400   |
| 2012-06-07  | 51598   | 4334      | 47264        | 595023681   | 35948144   | 559075537   |
| 2012-06-08  | 44106   | 6165      | 37941        | 466093336   | 37231899   | 428861437   |
| 2012-06-09  | 38248   | 4400      | 33848        | 361842510   | 25817439   | 336025071   |
| 2012-06-10  | 33004   | 3912      | 29092        | 304612645   | 21483368   | 283129277   |
| 2012-06-11  | 48415   | 7049      | 41366        | 499894880   | 32579680   | 467315200   |
| 2012-06-12  | 45327   | 2901      | 42426        | 532186890   | 20303620   | 511883270   |
| 2012-06-13  | 47013   | 4472      | 42541        | 514018015   | 32690936   | 481327079   |
| 2012-06-14  | 52426   | 3532      | 48894        | 574721054   | 26200392   | 548520662   |
| 2012-06-15  | 56598   | 3548      | 53050        | 743466833   | 22588220   | 720878613   |
| 2012-06-16  | 44589   | 2885      | 41704        | 529286050   | 20949991   | 508336059   |
| 2012-06-17  | 33985   | 4640      | 29345        | 324996908   | 31013306   | 293983602   |
| 2012-06-18  | 44328   | 2279      | 42049        | 509151555   | 20300138   | 488851417   |
| 2012-06-19  | 45782   | 3743      | 42039        | 509034582   | 24020678   | 485013904   |
| 2012-06-20  | 44543   | 2244      | 42299        | 507350059   | 16918543   | 490431516   |
| 2012-06-21  | 46199   | 2522      | 43677        | 518439643   | 22052642   | 496387001   |
| 2012-06-22  | 52912   | 2900      | 50012        | 576643582   | 18702561   | 557941021   |
| 2012-06-23  | 32032   | 2942      | 29090        | 316288006   | 17849966   | 298438040   |
| 2012-06-24  | 31071   | 2730      | 28341        | 317300505   | 14033685   | 303266820   |
| 2012-06-25  | 44329   | 3931      | 40398        | 479841987   | 21833527   | 458008460   |
| 2012-06-26  | 47776   | 4949      | 42827        | 525183458   | 31315948   | 493867510   |
| 2012-06-27  | 44594   | 2069      | 42525        | 514948635   | 15185634   | 499763001   |
| 2012-06-28  | 44448   | 2573      | 41875        | 494427688   | 15728724   | 478698964   |
| 2012-06-29  | 40186   | 3459      | 36727        | 436751779   | 19609975   | 417141804   |
| 2012-06-30  | 32152   | 2737      | 29415        | 317129809   | 18352730   | 298777079   |
| 2012-07-01  | 31346   | 3537      | 27809        | 304766176   | 20617479   | 284148697   |
| 2012-07-02  | 47361   | 6263      | 41098        | 504539570   | 32919771   | 471619799   |
| 2012-07-03  | 44405   | 3119      | 41286        | 495640274   | 20688529   | 474951745   |
| 2012-07-04  | 39830   | 3551      | 36279        | 437927611   | 26530751   | 411396860   |
| 2012-07-05  | 41370   | 2499      | 38871        | 460886965   | 22029712   | 438857253   |
| 2012-07-06  | 39374   | 1886      | 37488        | 429825368   | 15608623   | 414216745   |
| 2012-07-07  | 30640   | 2611      | 28029        | 299868348   | 19408385   | 280459963   |
| 2012-07-08  | 30207   | 2233      | 27974        | 310833458   | 14852758   | 295980700   |
| 2012-07-09  | 48220   | 4306      | 43914        | 550451217   | 21743104   | 528708113   |
| 2012-07-10  | 45734   | 3279      | 42455        | 516559413   | 23351839   | 493207574   |
| 2012-07-11  | 44168   | 3468      | 40700        | 499386552   | 29380919   | 470005633   |
| 2012-07-12  | 43949   | 2851      | 41098        | 513803215   | 31455584   | 482347631   |
| 2012-07-13  | 38609   | 1656      | 36953        | 432341790   | 12436706   | 419905084   |
| 2012-07-14  | 34148   | 4763      | 29385        | 337900461   | 34838115   | 303062346   |
| 2012-07-15  | 30739   | 2818      | 27921        | 298383276   | 18295491   | 280087785   |
| 2012-07-16  | 45413   | 4518      | 40895        | 489901959   | 30801365   | 459100594   |
| 2012-07-17  | 45282   | 2639      | 42643        | 516274916   | 24445469   | 491829447   |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
|  yearmonth  |  count  | botcount  | nonbotcount  |    size     |  botsize   | nonbotsize  |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
| 2012-07-18  | 43617   | 1714      | 41903        | 511686249   | 15373847   | 496312402   |
| 2012-07-19  | 42682   | 1436      | 41246        | 492419479   | 11256075   | 481163404   |
| 2012-07-20  | 46503   | 4251      | 42252        | 540654980   | 23851604   | 516803376   |
| 2012-07-21  | 33593   | 4121      | 29472        | 327266201   | 27881544   | 299384657   |
| 2012-07-22  | 33526   | 4284      | 29242        | 344420484   | 35545074   | 308875410   |
| 2012-07-23  | 53790   | 4649      | 49141        | 580025533   | 29956391   | 550069142   |
| 2012-07-24  | 45532   | 2466      | 43066        | 526294648   | 21201639   | 505093009   |
| 2012-07-25  | 44138   | 2556      | 41582        | 506006875   | 18303737   | 487703138   |
| 2012-07-26  | 46756   | 5050      | 41706        | 518003304   | 38035130   | 479968174   |
| 2012-07-27  | 45320   | 5654      | 39666        | 493143606   | 55436030   | 437707576   |
| 2012-07-28  | 39155   | 8676      | 30479        | 395061053   | 89166982   | 305894071   |
| 2012-07-29  | 34029   | 2950      | 31079        | 353346065   | 28733691   | 324612374   |
| 2012-07-30  | 46398   | 3219      | 43179        | 508573389   | 18684680   | 489888709   |
| 2012-07-31  | 46573   | 2608      | 43965        | 523079522   | 23233495   | 499846027   |
| 2012-08-01  | 48323   | 6472      | 41851        | 532852832   | 45088868   | 487763964   |
| 2012-08-02  | 44757   | 3373      | 41384        | 501379620   | 24625177   | 476754443   |
| 2012-08-03  | 39539   | 1482      | 38057        | 432102273   | 8747978    | 423354295   |
| 2012-08-04  | 32792   | 2624      | 30168        | 321623836   | 16872724   | 304751112   |
| 2012-08-05  | 34331   | 2719      | 31612        | 335218129   | 15522845   | 319695284   |
| 2012-08-06  | 49597   | 4005      | 45592        | 539798969   | 17883668   | 521915301   |
| 2012-08-07  | 49680   | 2857      | 46823        | 544722503   | 24053050   | 520669453   |
| 2012-08-08  | 49951   | 1892      | 48059        | 565779106   | 17949846   | 547829260   |
| 2012-08-09  | 45884   | 1708      | 44176        | 541109491   | 18939942   | 522169549   |
| 2012-08-10  | 44769   | 2126      | 42643        | 494190345   | 17126899   | 477063446   |
| 2012-08-11  | 32336   | 2519      | 29817        | 321004896   | 15237126   | 305767770   |
| 2012-08-12  | 33645   | 2597      | 31048        | 343410206   | 15839992   | 327570214   |
| 2012-08-13  | 46013   | 3475      | 42538        | 525020145   | 23022544   | 501997601   |
| 2012-08-14  | 43969   | 2354      | 41615        | 510652893   | 14335313   | 496317580   |
| 2012-08-15  | 43822   | 2684      | 41138        | 515270204   | 22644118   | 492626086   |
| 2012-08-16  | 44434   | 2440      | 41994        | 517607263   | 23513714   | 494093549   |
| 2012-08-17  | 83642   | 2972      | 80670        | 1133364949  | 23656535   | 1109708414  |
| 2012-08-18  | 39202   | 2261      | 36941        | 435874913   | 16077427   | 419797486   |
| 2012-08-19  | 34195   | 3518      | 30677        | 349246865   | 23293027   | 325953838   |
| 2012-08-20  | 45626   | 3653      | 41973        | 507364839   | 23757608   | 483607231   |
| 2012-08-21  | 45741   | 2357      | 43384        | 528987979   | 17937094   | 511050885   |
| 2012-08-22  | 44351   | 2308      | 42043        | 527616276   | 14805036   | 512811240   |
| 2012-08-23  | 41823   | 1923      | 39900        | 491079730   | 11420058   | 479659672   |
| 2012-08-24  | 40624   | 2026      | 38598        | 471488246   | 16229886   | 455258360   |
| 2012-08-25  | 33987   | 2509      | 31478        | 349188543   | 18592531   | 330596012   |
| 2012-08-26  | 34473   | 2784      | 31689        | 366473432   | 20642173   | 345831259   |
| 2012-08-27  | 47343   | 3446      | 43897        | 547174116   | 24764861   | 522409255   |
| 2012-08-28  | 49801   | 2066      | 47735        | 569669220   | 10716164   | 558953056   |
| 2012-08-29  | 70759   | 3010      | 67749        | 939809565   | 17253276   | 922556289   |
| 2012-08-30  | 88277   | 2823      | 85454        | 1436618627  | 19141652   | 1417476975  |
| 2012-08-31  | 70251   | 3023      | 67228        | 958448863   | 18312753   | 940136110   |
| 2012-09-01  | 33645   | 3919      | 29726        | 338540685   | 32881418   | 305659267   |
| 2012-09-02  | 33724   | 1890      | 31834        | 357924317   | 22220189   | 335704128   |
| 2012-09-03  | 41294   | 3411      | 37883        | 454568138   | 19571484   | 434996654   |
| 2012-09-04  | 47588   | 2655      | 44933        | 560298967   | 23380977   | 536917990   |
| 2012-09-05  | 45946   | 2569      | 43377        | 534677870   | 18508455   | 516169415   |
| 2012-09-06  | 43574   | 2229      | 41345        | 505709251   | 21076584   | 484632667   |
| 2012-09-07  | 43730   | 3714      | 40016        | 499292775   | 27549828   | 471742947   |
| 2012-09-08  | 34471   | 4609      | 29862        | 356141026   | 26169212   | 329971814   |
| 2012-09-09  | 32201   | 2813      | 29388        | 358664657   | 19862639   | 338802018   |
| 2012-09-10  | 47377   | 4365      | 43012        | 558354032   | 35353415   | 523000617   |
| 2012-09-11  | 43889   | 2181      | 41708        | 525107994   | 21105798   | 504002196   |
| 2012-09-12  | 47904   | 1971      | 45933        | 568849453   | 21466624   | 547382829   |
| 2012-09-13  | 53582   | 2974      | 50608        | 597984167   | 37724832   | 560259335   |
| 2012-09-14  | 42216   | 3611      | 38605        | 502255571   | 37891470   | 464364101   |
| 2012-09-15  | 35334   | 4550      | 30784        | 414550225   | 43350497   | 371199728   |
| 2012-09-16  | 32291   | 3679      | 28612        | 351584089   | 43857615   | 307726474   |
| 2012-09-17  | 47353   | 4210      | 43143        | 596238301   | 50388602   | 545849699   |
| 2012-09-18  | 46910   | 3925      | 42985        | 555795451   | 44336188   | 511459263   |
| 2012-09-19  | 47828   | 4162      | 43666        | 568924876   | 42220447   | 526704429   |
| 2012-09-20  | 49539   | 5267      | 44272        | 606871320   | 65758205   | 541113115   |
| 2012-09-21  | 44395   | 4033      | 40362        | 541287708   | 45508174   | 495779534   |
| 2012-09-22  | 36098   | 4180      | 31918        | 417176387   | 53650561   | 363525826   |
| 2012-09-23  | 33910   | 3609      | 30301        | 394782206   | 50757562   | 344024644   |
| 2012-09-24  | 52321   | 4975      | 47346        | 650745025   | 57831510   | 592913515   |
| 2012-09-25  | 51020   | 4579      | 46441        | 630121828   | 53534061   | 576587767   |
| 2012-09-26  | 49572   | 3570      | 46002        | 616642228   | 54621516   | 562020712   |
| 2012-09-27  | 47672   | 3140      | 44532        | 604626748   | 47140755   | 557485993   |
| 2012-09-28  | 43056   | 3220      | 39836        | 524643278   | 39181037   | 485462241   |
| 2012-09-29  | 36558   | 3632      | 32926        | 429589638   | 46171591   | 383418047   |
| 2012-09-30  | 36968   | 4798      | 32170        | 410769224   | 42082526   | 368686698   |
| 2012-10-01  | 51954   | 5051      | 46903        | 597344956   | 41445783   | 555899173   |
| 2012-10-02  | 49426   | 4453      | 44973        | 616535476   | 54932613   | 561602863   |
| 2012-10-03  | 49588   | 5080      | 44508        | 602636119   | 58148766   | 544487353   |
| 2012-10-04  | 51336   | 4869      | 46467        | 625642275   | 58445171   | 567197104   |
| 2012-10-05  | 48093   | 5012      | 43081        | 596749152   | 62315732   | 534433420   |
| 2012-10-06  | 36524   | 5418      | 31106        | 412829861   | 56741904   | 356087957   |
| 2012-10-07  | 36863   | 4559      | 32304        | 420025303   | 53244193   | 366781110   |
| 2012-10-08  | 51819   | 5735      | 46084        | 623608569   | 60327152   | 563281417   |
| 2012-10-09  | 50902   | 5856      | 45046        | 624038332   | 65446806   | 558591526   |
| 2012-10-10  | 49655   | 3904      | 45751        | 610870867   | 53060012   | 557810855   |
| 2012-10-11  | 51056   | 4224      | 46832        | 634905149   | 49994753   | 584910396   |
| 2012-10-12  | 51110   | 6832      | 44278        | 614858838   | 73318826   | 541540012   |
| 2012-10-13  | 39010   | 4965      | 34045        | 454604632   | 57093068   | 397511564   |
| 2012-10-14  | 37932   | 4978      | 32954        | 425521193   | 40666354   | 384854839   |
| 2012-10-15  | 51781   | 5576      | 46205        | 612322527   | 40695511   | 571627016   |
| 2012-10-16  | 52172   | 4946      | 47226        | 615905866   | 36233383   | 579672483   |
| 2012-10-17  | 51921   | 3715      | 48206        | 614678214   | 31834443   | 582843771   |
| 2012-10-18  | 50611   | 3019      | 47592        | 620954746   | 32608670   | 588346076   |
| 2012-10-19  | 46272   | 3041      | 43231        | 550864306   | 33248221   | 517616085   |
| 2012-10-20  | 34300   | 3075      | 31225        | 384815241   | 38267320   | 346547921   |
| 2012-10-21  | 37843   | 4287      | 33556        | 413805463   | 45147852   | 368657611   |
| 2012-10-22  | 52731   | 4730      | 48001        | 634382463   | 44804186   | 589578277   |
| 2012-10-23  | 76832   | 3655      | 73177        | 806083317   | 38537515   | 767545802   |
| 2012-10-24  | 54680   | 6169      | 48511        | 668482809   | 74348702   | 594134107   |
| 2012-10-25  | 48057   | 2693      | 45364        | 590736514   | 36005718   | 554730796   |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
|  yearmonth  |  count  | botcount  | nonbotcount  |    size     |  botsize   | nonbotsize  |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
| 2012-10-26  | 58787   | 3093      | 55694        | 718603870   | 32634490   | 685969380   |
| 2012-10-27  | 35424   | 4751      | 30673        | 382092034   | 35253530   | 346838504   |
| 2012-10-28  | 41441   | 7247      | 34194        | 441669486   | 54603945   | 387065541   |
| 2012-10-29  | 52894   | 5730      | 47164        | 643860819   | 50875034   | 592985785   |
| 2012-10-30  | 49012   | 3977      | 45035        | 578442015   | 41970122   | 536471893   |
| 2012-10-31  | 49985   | 5050      | 44935        | 598406566   | 42856835   | 555549731   |
| 2012-11-01  | 47300   | 3808      | 43492        | 571812430   | 40445034   | 531367396   |
| 2012-11-02  | 46864   | 6473      | 40391        | 539611316   | 57785254   | 481826062   |
| 2012-11-03  | 38102   | 4745      | 33357        | 415522566   | 47018098   | 368504468   |
| 2012-11-04  | 41539   | 4479      | 37060        | 452187986   | 52076131   | 400111855   |
| 2012-11-05  | 55524   | 6634      | 48890        | 657801833   | 60735333   | 597066500   |
| 2012-11-06  | 49162   | 4286      | 44876        | 605520083   | 52516474   | 553003609   |
| 2012-11-07  | 54434   | 8254      | 46180        | 650257691   | 73251328   | 577006363   |
| 2012-11-08  | 57940   | 10910     | 47030        | 667977183   | 86527119   | 581450064   |
| 2012-11-09  | 48019   | 4921      | 43098        | 581214308   | 60641887   | 520572421   |
| 2012-11-10  | 37276   | 4703      | 32573        | 415992970   | 46614783   | 369378187   |
| 2012-11-11  | 35712   | 3895      | 31817        | 410493516   | 46974106   | 363519410   |
| 2012-11-12  | 48724   | 5069      | 43655        | 584726479   | 47260491   | 537465988   |
| 2012-11-13  | 46702   | 2862      | 43840        | 551398666   | 19704226   | 531694440   |
| 2012-11-14  | 49139   | 3474      | 45665        | 592340418   | 30849530   | 561490888   |
| 2012-11-15  | 47646   | 4144      | 43502        | 567521758   | 37104584   | 530417174   |
| 2012-11-16  | 44271   | 2431      | 41840        | 452873463   | 19842955   | 433030508   |
| 2012-11-17  | 36255   | 3011      | 33244        | 336939142   | 29264297   | 307674845   |
| 2012-11-18  | 37753   | 4269      | 33484        | 340468033   | 28914147   | 311553886   |
| 2012-11-19  | 61673   | 15941     | 45732        | 579166275   | 105356907  | 473809368   |
| 2012-11-20  | 47280   | 2554      | 44726        | 498474894   | 21145857   | 477329037   |
| 2012-11-21  | 48674   | 4680      | 43994        | 478947683   | 28736392   | 450211291   |
| 2012-11-22  | 43390   | 4557      | 38833        | 426608741   | 33982891   | 392625850   |
| 2012-11-23  | 41530   | 4531      | 36999        | 391982575   | 31050604   | 360931971   |
| 2012-11-24  | 36221   | 3364      | 32857        | 339185023   | 26579656   | 312605367   |
| 2012-11-25  | 39598   | 4493      | 35105        | 364110815   | 34763910   | 329346905   |
| 2012-11-26  | 51290   | 5016      | 46274        | 534105774   | 33444105   | 500661669   |
| 2012-11-27  | 57018   | 7971      | 49047        | 576652299   | 48148844   | 528503455   |
| 2012-11-28  | 50455   | 3322      | 47133        | 532607338   | 24828008   | 507779330   |
| 2012-11-29  | 47889   | 3282      | 44607        | 509134120   | 23896228   | 485237892   |
| 2012-11-30  | 48064   | 4864      | 43200        | 486565675   | 40807320   | 445758355   |
| 2012-12-01  | 36890   | 5598      | 31292        | 324616220   | 38263152   | 286353068   |
| 2012-12-02  | 35598   | 3506      | 32092        | 325190758   | 23224779   | 301965979   |
| 2012-12-03  | 48562   | 3706      | 44856        | 514394176   | 27412065   | 486982111   |
| 2012-12-04  | 55321   | 8385      | 46936        | 544015245   | 50517662   | 493497583   |
| 2012-12-05  | 52278   | 7984      | 44294        | 511688175   | 49538914   | 462149261   |
| 2012-12-06  | 52946   | 7305      | 45641        | 535637265   | 51575962   | 484061303   |
| 2012-12-07  | 48368   | 6616      | 41752        | 478799246   | 64575763   | 414223483   |
| 2012-12-08  | 36343   | 5894      | 30449        | 326900983   | 61191477   | 265709506   |
| 2012-12-09  | 38365   | 6325      | 32040        | 355161137   | 61576035   | 293585102   |
| 2012-12-10  | 54561   | 6664      | 47897        | 550522310   | 71697313   | 478824997   |
| 2012-12-11  | 51015   | 4700      | 46315        | 545091236   | 56139072   | 488952164   |
| 2012-12-12  | 48546   | 5295      | 43251        | 506448864   | 53604986   | 452843878   |
| 2012-12-13  | 50716   | 6944      | 43772        | 519449806   | 58445988   | 461003818   |
| 2012-12-14  | 47454   | 7565      | 39889        | 456796862   | 55000158   | 401796704   |
| 2012-12-15  | 39109   | 8051      | 31058        | 346110788   | 70137072   | 275973716   |
| 2012-12-16  | 36380   | 6252      | 30128        | 329497033   | 58935642   | 270561391   |
| 2012-12-17  | 51612   | 7489      | 44123        | 529361817   | 64104001   | 465257816   |
| 2012-12-18  | 53453   | 5185      | 48268        | 552956282   | 58395963   | 494560319   |
| 2012-12-19  | 55060   | 9706      | 45354        | 566332514   | 112782415  | 453550099   |
| 2012-12-20  | 59174   | 9492      | 49682        | 628042140   | 105515985  | 522526155   |
| 2012-12-21  | 53010   | 10585     | 42425        | 538276257   | 134702939  | 403573318   |
| 2012-12-22  | 34297   | 5612      | 28685        | 306610405   | 56364126   | 250246279   |
| 2012-12-23  | 33614   | 4770      | 28844        | 285086421   | 50262265   | 234824156   |
| 2012-12-24  | 42068   | 6050      | 36018        | 334727299   | 51751987   | 282975312   |
| 2012-12-25  | 35018   | 5519      | 29499        | 299727218   | 54020058   | 245707160   |
| 2012-12-26  | 36262   | 4489      | 31773        | 346137607   | 50070829   | 296066778   |
| 2012-12-27  | 40581   | 4534      | 36047        | 405583999   | 49985231   | 355598768   |
| 2012-12-28  | 39639   | 3610      | 36029        | 392865580   | 38383697   | 354481883   |
| 2012-12-29  | 53601   | 7268      | 46333        | 547106210   | 57888226   | 489217984   |
| 2012-12-30  | 38363   | 8114      | 30249        | 309721635   | 62764095   | 246957540   |
| 2012-12-31  | 39380   | 9976      | 29404        | 329765107   | 73823812   | 255941295   |
| 2013-01-01  | 12427   | 3840      | 8587         | 86737082    | 30035913   | 56701169    |
+-------------+---------+-----------+--------------+-------------+------------+-------------+--+
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
0: jdbc:hive2://localhost:10000> 
